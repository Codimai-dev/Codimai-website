<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex, nofollow">
  <title>Blog Builder - CodimAi Admin</title>
  
  <!-- Favicon -->
  <link rel="icon" href="img/favicon.ico">
  
  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Saira:wght@500;600;700;800&display=swap" rel="stylesheet">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.css">
  
  <!-- AOS Animation -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet">
  
  <!-- Custom Styles -->
   <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="css/admin-blog-builder.css">
</head>
<body>
  <!-- Loading Spinner -->
<div id="spinner" class="themed-spinner-overlay cosmic-spinner-overlay" style="display: none;">

  <div class="themed-spinner-bg cosmic-spinner-bg">
    
    <div class="spinner-orbs cosmic-orbs">
      <div class="spinner-orb orb-1"></div>
      <div class="spinner-orb orb-2"></div>
      <div class="spinner-orb orb-3"></div>
    </div>

    <div class="spinner-grid cosmic-grid"></div>
  </div>

  <div class="themed-spinner cosmic-main-spinner"></div>

</div>


  <!-- HEADER -->
<header class="admin-header cosmic-header">
  <div class="header-left">
    <h1 class="header-title">
      <i class="fas fa-rocket"></i>
      CodimAi Blog Builder
    </h1>
  </div>

  <div class="header-actions">

    <div class="user-info cosmic-user">
      <i class="fas fa-user-circle user-icon"></i>
      <span id="userEmail"></span>
    </div>

    <button id="logoutBtn" class="btn-primary btn-logout cosmic-logout">
      <i class="fas fa-sign-out-alt"></i>
      Logout
    </button>

  </div>
</header>

  <!-- MAIN -->
  <main class="admin-content">

    <!-- TABS -->
    <nav class="tabs">
      <button class="tab-btn active" data-tab="create">
        <i class="fas fa-plus-circle"></i> Create New Post
      </button>

      <button class="tab-btn" data-tab="manage">
        <i class="fas fa-list"></i> Manage Posts
      </button>

      <button class="tab-btn" data-tab="markdown">
        <i class="fas fa-file-upload"></i> Upload Markdown
      </button>
    </nav>

    <!-- CREATE NEW POST -->
    <section id="createTab" class="tab-content active">
      <div class="form-section">

        <h2 class="section-heading">
          <i class="fas fa-edit"></i> Create New Blog Post
        </h2>

        <!-- AI GENERATION -->
        <div class="ai-section">
          <h3><i class="fas fa-magic"></i> Generate with AI</h3>
          <p class="section-description">
            Let AI generate content based on topic & keywords.
          </p>

          <div class="form-group">
            <label for="aiTopic"><i class="fas fa-lightbulb"></i> Blog Topic *</label>
            <input id="aiTopic" type="text" class="input-field" placeholder="Future of AI in Healthcare">
          </div>

          <div class="form-group">
            <label for="aiKeywords"><i class="fas fa-tags"></i> Keywords</label>
            <input id="aiKeywords" type="text" class="input-field" placeholder="AI, machine learning...">
            <small class="note">Optional: Add focused keywords.</small>
          </div>

          <button id="generateContentBtn" class="btn-primary">
            <i class="fas fa-sparkles"></i> Generate Content with AI
          </button>
        </div>

        <div class="divider"><span>OR CREATE MANUALLY</span></div>

        <!-- MANUAL ENTRY -->
        <div class="manual-section">

          <h3><i class="fas fa-keyboard"></i> Manual Entry</h3>

          <div class="form-group">
            <label for="blogTitle"><i class="fas fa-heading"></i> Title *</label>
            <input id="blogTitle" type="text" class="input-field" placeholder="Enter title...">
          </div>

          <div class="form-group">
            <label for="blogSlug"><i class="fas fa-link"></i> URL Slug</label>
            <input id="blogSlug" type="text" class="input-field" placeholder="auto-generated-from-title">
            <small class="note">Auto-generated from title, or customize.</small>
          </div>

          <div class="two-column">
            <div class="form-group">
              <label for="blogAuthor"><i class="fas fa-user-edit"></i> Author</label>
              <input id="blogAuthor" type="text" class="input-field" value="CodimAi Team">
            </div>

            <div class="form-group">
              <label for="blogCategory"><i class="fas fa-folder"></i> Category</label>
              <select id="blogCategory" class="input-field select-field">
                <option>AI Automation</option>
                <option>Machine Learning</option>
                <option>Business Growth</option>
                <option>Web Development</option>
                <option>SEO & Marketing</option>
                <option>Tutorial & Guide</option>
                <option>News & Updates</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="blogExcerpt"><i class="fas fa-align-left"></i> Excerpt</label>
            <textarea id="blogExcerpt" rows="3" class="input-field"></textarea>
            <small class="note">Appears in blog cards & search.</small>
          </div>

          <!-- EDITOR -->
          <div class="form-group">
            <label for="blogContent"><i class="fas fa-file-alt"></i> Content (Markdown Supported)</label>

            <div class="editor-toolbar">
              <button class="toolbar-btn" data-action="bold"><i class="fas fa-bold"></i></button>
              <button class="toolbar-btn" data-action="italic"><i class="fas fa-italic"></i></button>
              <button class="toolbar-btn" data-action="heading"><i class="fas fa-heading"></i></button>
              <button class="toolbar-btn" data-action="link"><i class="fas fa-link"></i></button>
              <button class="toolbar-btn" data-action="image"><i class="fas fa-image"></i></button>
              <button class="toolbar-btn" data-action="video"><i class="fas fa-video"></i></button>
              <button class="toolbar-btn" data-action="code"><i class="fas fa-code"></i></button>
              <button class="toolbar-btn" data-action="list"><i class="fas fa-list"></i></button>
              <button class="toolbar-btn" data-action="quote"><i class="fas fa-quote-right"></i></button>
            </div>

            <textarea id="blogContent" rows="18" class="input-field editor-textarea"></textarea>
          </div>

          <div class="form-group">
            <label for="blogMetaDesc"><i class="fas fa-search"></i> Meta Description</label>
            <textarea id="blogMetaDesc" rows="2" maxlength="160" class="input-field"></textarea>
            <div class="meta-footer">
              <small class="note">150â€“160 characters for SEO.</small>
              <small class="char-count"><span id="metaCharCount">0</span>/160</small>
            </div>
          </div>

          <div class="form-group">
            <label for="blogTags"><i class="fas fa-hashtag"></i> Tags</label>
            <input id="blogTags" type="text" class="input-field" placeholder="ai, technology...">
          </div>

          <!-- PUBLISH -->
          <div class="publish-section">
            <h3><i class="fas fa-rocket"></i> Publishing Options</h3>

            <label class="checkbox-row">
              <input type="checkbox" id="publishNow" checked>
              <span>Publish immediately</span>
            </label>
          </div>

          <!-- ACTION BUTTONS -->
          <div class="form-actions">
            <button id="previewBtn" class="btn-secondary"><i class="fas fa-eye"></i> Preview</button>
            <button id="saveDraftBtn" class="btn-secondary"><i class="fas fa-save"></i> Save Draft</button>
            <button id="publishBtn" class="btn-primary"><i class="fas fa-paper-plane"></i> Publish</button>
          </div>
        </div>
      </div>
    </section>

    <!-- MANAGE POSTS -->
    <section id="manageTab" class="tab-content">
      <div class="manage-section">

        <div class="section-header">
          <h2 class="section-heading"><i class="fas fa-list"></i> Manage Blog Posts</h2>
          <button id="refreshPostsBtn" class="btn-secondary"><i class="fas fa-sync-alt"></i> Refresh</button>
        </div>

        <div class="filter-section">
          <div class="search-box">
            <i class="fas fa-search"></i>
            <input id="searchPosts" type="text" class="input-field" placeholder="Search...">
          </div>

          <select id="filterStatus" class="input-field select-field">
            <option value="all">All Posts</option>
            <option value="published">Published</option>
            <option value="draft">Drafts</option>
          </select>
        </div>

        <div id="postsTable" class="posts-table">
          <table>
            <thead>
              <tr>
                <th>Title</th>
                <th>Author</th>
                <th>Category</th>
                <th>Status</th>
                <th>Date</th>
                <th>Actions</th>
              </tr>
            </thead>

            <tbody id="postsTableBody">
              <tr>
                <td colspan="6" class="loading-cell">
                  <div class="loading-spinner-small"></div>
                  <p>Loading posts...</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- MARKDOWN UPLOAD -->
    <section id="markdownTab" class="tab-content">
      <div class="upload-section">

        <h2 class="section-heading"><i class="fas fa-file-code"></i> Upload Markdown File</h2>
        <p class="section-description">Drag & drop your .md file to convert automatically.</p>

        <div id="markdownDropZone" class="upload-area">
          <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
          <h3 class="upload-text">Drag & drop your .md file here</h3>
          <p class="upload-subtext">or</p>

          <button id="selectMarkdownBtn" class="btn-primary">
            <i class="fas fa-folder-open"></i> Select File
          </button>

          <input id="markdownFile" type="file" accept=".md,.markdown" hidden>

          <small class="note">Supports full markdown, code blocks, videos, images.</small>
        </div>

        <!-- PREVIEW -->
        <div id="markdownPreview" class="markdown-preview-section" style="display:none;">
          <h3 class="preview-heading"><i class="fas fa-eye"></i> Preview</h3>
          <div id="markdownContent" class="preview-content"></div>

          <div class="markdown-meta">
            <h3><i class="fas fa-cog"></i> Post Information</h3>

            <div class="two-column">
              <div class="form-group">
                <label for="mdAuthor"><i class="fas fa-user-edit"></i> Author</label>
                <input id="mdAuthor" type="text" class="input-field" value="CodimAi Team">
              </div>

              <div class="form-group">
                <label for="mdCategory"><i class="fas fa-folder"></i> Category</label>
                <select id="mdCategory" class="input-field select-field">
                  <option>AI Automation</option>
                  <option>Machine Learning</option>
                  <option>Business Growth</option>
                  <option>Web Development</option>
                  <option>SEO & Marketing</option>
                  <option>Tutorial & Guide</option>
                  <option>News & Updates</option>
                </select>
              </div>
            </div>

            <div class="form-actions">
              <button id="cancelMarkdownBtn" class="btn-secondary"><i class="fas fa-times"></i> Cancel</button>
              <button id="publishMarkdownBtn" class="btn-primary"><i class="fas fa-paper-plane"></i> Publish from Markdown</button>
            </div>
          </div>
        </div>
      </div>
    </section>

  </main>

<!-- ========== LOADING OVERLAY ========== -->
<div id="loadingOverlay" class="loading-overlay cosmic-overlay" style="display: none;">
  <div class="loading-spinner cosmic-spinner"></div>
  <p id="loadingText" class="loading-text">Processing...</p>
</div>

<!-- ========== PREVIEW MODAL ========== -->
<div id="previewModal" class="modal cosmic-modal" style="display: none;">
  <div class="modal-content cosmic-modal-content">
    
    <div class="modal-header cosmic-modal-header">
      <h2>
        <i class="fas fa-eye"></i>
        Preview
      </h2>
      <button class="modal-close cosmic-modal-close" id="closePreviewBtn">
        <i class="fas fa-times"></i>
      </button>
    </div>

    <div class="modal-body cosmic-modal-body" id="previewContent"></div>
  </div>
</div>

<!-- ========== TOAST NOTIFICATION ========== -->
<div id="toast" class="toast cosmic-toast" style="display: none;">
  <i class="toast-icon fas fa-check-circle"></i>
  <span class="toast-message"></span>
</div>

  <!-- Firebase Configuration (shared) -->
  <script type="module">
    import { auth } from './js/firebase-config.js';
    import { onAuthStateChanged, signOut } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

    // Keep single auth instance across admin pages
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        window.location.href = 'admin-login.html';
      } else {
        const emailSpan = document.querySelector('#userEmail span');
        if (emailSpan) emailSpan.textContent = user.email;
      }
    });

    // Logout handler
    window.handleLogout = async () => {
      try {
        await signOut(auth);
        window.location.href = 'admin-login.html';
      } catch (error) {
        console.error('Logout error:', error);
        alert('Error logging out');
      }
    };
  </script>

  <!-- Admin Blog Builder JS -->
  <script src="js/admin-blog.js" type="module"></script>
  <script type="module" src="js/admin-blog-builder.js"></script>
</body>
</html>
